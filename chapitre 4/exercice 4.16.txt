if (p = getPtr() != 0)
赋值运算符的优先级很低，会先算!=
修改为if ( (p = getPtr()) != 0 )

if(i = 1024)
赋值运算符要改成等号运算符才对
if(i == 1024)